<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.034d9cba9deb1f52db75fa0931ca0fc2bba85beb0b9acc665c7d9736bb78dd22a4631f6e5e1f60c880c640e8a2fa42a2ef762e82830c85f9e4a30d8d52c2a6e9.css integrity="sha512-A02cup3rH1LbdfoJMcoPwruoW+sLmsxmXH2XNrt43SKkYx9uXh9gyIDGQOii+kKi73YugoMMhfnkow2NUsKm6Q==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Tarea 4: Seguridad Web - Introducción a la Seguridad Computacional</title><meta name=description content="DCC universidad de Chile"><link rel=canonical href=/tareas/tarea-4/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo_redondo.png"><meta name=twitter:title content="Tarea 4: Seguridad Web"><meta name=twitter:description content="Instrucciones La siguiente actividad está pensada para su desarrollo en un bloque de auxiliar y un poco más (~3 horas), en grupos de dos personas como máximo. El plazo de entrega es hasta el miércoles 22 de junio, a las 23:59 hrs. Antes de partir, recuerden leer la sección de reglas de tareas.
Pregunta única: Capture the flag Esta tarea está inspirada en los eventos de Capture the Flag realizados por comunidades de hacking desde hace mucho tiempo."><meta name=twitter:site content="@dccuchile"><meta name=twitter:creator content="@dccuchile"><meta property="og:title" content="Tarea 4: Seguridad Web"><meta property="og:description" content="Instrucciones La siguiente actividad está pensada para su desarrollo en un bloque de auxiliar y un poco más (~3 horas), en grupos de dos personas como máximo. El plazo de entrega es hasta el miércoles 22 de junio, a las 23:59 hrs. Antes de partir, recuerden leer la sección de reglas de tareas.
Pregunta única: Capture the flag Esta tarea está inspirada en los eventos de Capture the Flag realizados por comunidades de hacking desde hace mucho tiempo."><meta property="og:type" content="article"><meta property="og:url" content="/tareas/tarea-4/"><meta property="og:image" content="/logo_redondo.png"><meta property="article:published_time" content="2020-06-10T09:00:00-03:00"><meta property="article:modified_time" content="2022-06-16T21:04:20-04:00"><meta property="og:site_name" content="Introducción a la Seguridad Computacional"><meta property="article:publisher" content="https://www.facebook.com/DCCUChile"><meta property="article:author" content="https://www.facebook.com/DCCUChile"><meta property="og:locale" content="es_CL"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Tareastarea 4","item":"\/tareastarea-4\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="tareas single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/><img class=logo-light src=/images/banner.svg></img>
<img class=logo-dark src=/images/banner_dark.svg></img></a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/cc5327/apunte><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=/acerca>Info</a></li><li class=nav-item><a class=nav-link href=/auxiliares/enunciados/auxiliar-1>Auxiliares</a></li><li class=nav-item><a class=nav-link href=/tareas/>Tareas</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Buscar Documentación..." aria-label="Buscar Documentación..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row justify-content-center"><div class="col-md-12 col-lg-10 col-xl-8"><article><div class=blog-header><h1>Tarea 4: Seguridad Web</h1><p><small>Publicado el 10/06/2020&nbsp;&dash;&nbsp;<strong>Lectura de 4&nbsp;mins</strong></small><p></div><p class=lead></p><h2 id=instrucciones>Instrucciones</h2><p>La siguiente actividad está pensada para su desarrollo en un bloque de auxiliar y un poco más (~3 horas), en grupos de dos personas como máximo. El plazo de entrega es hasta el <strong>miércoles 22 de junio, a las 23:59 hrs</strong>. Antes de partir, recuerden leer la sección de <a href=../reglas/>reglas de tareas</a>.</p><h3 id=pregunta-única-capture-the-flag>Pregunta única: Capture the flag</h3><p>Esta tarea está inspirada en los eventos de <em>Capture the Flag</em> realizados por comunidades de hacking desde hace mucho tiempo. Si luego de la tarea encuentran que les interesan este tipo de desafíos, les recomendamos partir por <a href=https://securityeducationresourcecollection.net/>este enlace</a> (categoría: CTF) para buscar otros ejercicios similares y disponibles en Internet.</p><p>El objetivo de esta actividad es encontrar un valor secreto (Flag) escondido en la misma base de datos de la aplicación web entregada. La URL sobre la que debe trabajar cada grupo será enviada de forma directa, y es &ldquo;secreta&rdquo; (nadie aparte de ustedes y el equipo docente debería poder acceder al sitio de forma directa). Lo anterior es para evitar que externos no autorizados por ustedes interactúen con su instancia. Para poder acceder a su contenido deben <strong>conectarse a través de la VPN del CEC</strong>.</p><h4 id=primera-parte-xss-3-puntos>Primera parte: XSS (3 puntos)</h4><p>Partiremos obteniendo acceso al panel de administración de la página entregada. Al intentar realizar inyecciones SQL tanto en el formulario de visitas como en el de inicio de sesión, notan que no están teniendo resultados. Sin embargo, ustedes saben de fuentes confiables que este restaurante tiene un empleado muy motivado e indeciso, el cual cambia el nombre del plato del día cada ciertos segundos y luego va a la página inicial a ver cómo quedó. Para poder hacer el cambio, el empleado se encuentra autentificado en el sitio como administrador.</p><p>Su objetivo es adquirir acceso como el usuario empleado del sitio a través de una inyección XSS en la base de datos del libro de visitas. Agregue el código que usó y describa en su informe los pasos que siguieron para esto. Es necesario que expliquen también al menos dos mitigaciones que hubiesen hecho que su ataque no resultara, con sus beneficios y limitaciones (las mitigaciones pueden ser al mismo problema o a problemas distintos).</p><p><strong>Consejo 1:</strong> El empleado que navega por la página podría dejar de hacerlo temporalmente si ésta es severamente modificada (por ejemplo, agregando diálogos de alerta). Para corregir estos problemas, puede ir a la página <code>/reset.php</code>, lo cual devuelve la base de datos del sitio a su estado habitual.</p><h4 id=segunda-parte-inyección-sql-ciega-3-puntos>Segunda parte: Inyección SQL Ciega (3 puntos)</h4><p>En el panel de administración, encuentran el formulario que se usa para cambiar el plato del día. Experimentando, notan que algunas entradas entregan un error de tipo SQL. Sospechan entonces que es posible realizar una inyección SQL ciega para extraer la flag que busca.</p><p>Si bien ustedes sabe que podría <a href=http://pentestmonkey.net/cheat-sheet/sql-injection/postgres-sql-injection-cheat-sheet>obtener información de la estructura de la tabla</a> con este tipo de inyecciones, prefieren preguntar a un informante infiltrado en el restaurante por la estructura de la tabla para ahorrar tiempo. Esta persona les dice que la tabla del plato del día se llama <code>configuraciones</code>, posee dos columnas (<code>nombre</code> y <code>valor</code>) y que se guarda la flag en la columna <code>valor</code> bajo el <code>nombre</code> <code>FLAG</code>. La flag está compuesta solamente letras mayúsculas, minúsculas y números.</p><p>Desarrollen un script que realice de forma automática las consultas sobre el formulario y extraiga la flag (incluyendo el código que usan para hacer la inyección SQL ciega). Expliquen en su informe los pasos que siguieron para esto y adjunten el script desarrollado. Expliquen además dos mitigaciones posibles para el o los problemas que le permitieron extraer este valor, con sus beneficios y limitaciones.</p><p><strong>Consejo 2:</strong> Para el correcto funcionamiento del script, necesitan contar con la <code>cookie</code> de inicio de sesión del administrador. Si están usando la librería Python-Requests, es recomendable que sigan <a href=https://requests.readthedocs.io/en/latest/user/quickstart/#cookies>este ejemplo</a> para entender como agregar la cookie a sus consultas.</p><p><strong>Consejo 3:</strong> La inyección SQL tal cual como se hizo en la auxiliar 5 traerá problemas. Esto debido a que la consulta SQL usada para cambiar el plato del día es algo similar a <code>UPDATE configuraciones SET value = '$plato' WHERE name = 'platodeldia'</code>. Si su inyección parte con <code>'; &lt;lo demás> -- </code>, la primera instrucción SQL quedará de la forma <code>UPDATE configuraciones SET value = '';</code>. Esto cambia el valor de TODAS las filas de la tabla configuraciones, eliminando del paso el valor de <code>FLAG</code>. Por lo tanto, necesitan inventar una forma de &ldquo;anular&rdquo; el update anterior. Para devolver la flag a la tabla, ejecuten <code>reset.php</code> (Eliminará también los cambios en la tabla de comentarios).</p><p><strong>Consejo 4:</strong> Se considerará válida una respuesta que no involucre inyecciones SQL ciegas, siempre y cuando se detalle completamente el método seguido y se adjunte un script que realice este trabajo de forma automática, contando solamente con la cookie de administrador.</p></article></div></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Sitio generado con <a href=https://gohugo.io/>Hugo</a> y <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target=_blank rel="license noopener noreferrer" style=display:inline-block>CC BY-SA 4.0<img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></ul></div></div></div></footer><script src=/main.2507c05f91ee016250e43b67b3d342f5a0d9d4dc5264f76cdc4518cd36a9e04cf3022ce8362802e618d8130b6733b53ee845a49e67229eeb3d3e70347db96a2b.js integrity="sha512-JQfAX5HuAWJQ5Dtns9NC9aDZ1NxSZPds3EUYzTap4EzzAizoNigC5hjYEwtnM7U+6EWknmcinus9PnA0fblqKw==" crossorigin=anonymous defer></script><script src=/index.min.95c2fb57984ca6cb1914e6658c1095cc47073a398c805d5ee842114fab739d64b4d5cd0626cda1be56c95e7f8c6e9c4d231866d1065245c873d731a6a7b01c5e.js integrity="sha512-lcL7V5hMpssZFOZljBCVzEcHOjmMgF1e6EIRT6tznWS01c0GJs2hvlbJXn+MbpxNIxhm0QZSRchz1zGmp7AcXg==" crossorigin=anonymous defer></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>