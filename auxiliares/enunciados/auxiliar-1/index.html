<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.c491d69a2d8366bc4edd3136ef418a924d17d247781b42a3666c117279726425a20190dae0c40336e80c273d9ea7176be98752329840383830a0e0d67c505163.css integrity="sha512-xJHWmi2DZrxO3TE270GKkk0X0kd4G0KjZmwRcnlyZCWiAZDa4MQDNugMJz2epxdr6YdSMphAODgwoODWfFBRYw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Auxiliar 1 - Introducci칩n a la Seguridad Computacional</title><meta name=description content="DCC universidad de Chile"><link rel=canonical href=/auxiliares/enunciados/auxiliar-1/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo_redondo.png"><meta name=twitter:title content="Auxiliar 1"><meta name=twitter:description content="En esta auxiliar veremos el modo de uso de la librer칤a Cryptography, adem치s de algunos ejercicios relacionados con ella.
游녤  En aplicaciones reales, es muy poco probable que tengas que usar estas primitivas de forma directa. Por lo mismo, la librer칤a Cryptography las agrupa en un paquete denominado hazmat (en espa침ol, material peligroso que causa riesgos a la vida o al ambiente si no es manejado con precauci칩n)  Cifradores de Bloque Puedes ver la documentaci칩n de Cryptography sobre este tema ac치."><meta name=twitter:site content="@dccuchile"><meta name=twitter:creator content="@dccuchile"><meta property="og:title" content="Auxiliar 1"><meta property="og:description" content="En esta auxiliar veremos el modo de uso de la librer칤a Cryptography, adem치s de algunos ejercicios relacionados con ella.
游녤  En aplicaciones reales, es muy poco probable que tengas que usar estas primitivas de forma directa. Por lo mismo, la librer칤a Cryptography las agrupa en un paquete denominado hazmat (en espa침ol, material peligroso que causa riesgos a la vida o al ambiente si no es manejado con precauci칩n)  Cifradores de Bloque Puedes ver la documentaci칩n de Cryptography sobre este tema ac치."><meta property="og:type" content="article"><meta property="og:url" content="/auxiliares/enunciados/auxiliar-1/"><meta property="og:image" content="/logo_redondo.png"><meta property="article:published_time" content="2020-03-18T20:12:32-03:00"><meta property="article:modified_time" content="2022-04-02T23:10:02+02:00"><meta property="og:site_name" content="Introducci칩n a la Seguridad Computacional"><meta property="article:publisher" content="https://www.facebook.com/DCCUChile"><meta property="article:author" content="https://www.facebook.com/DCCUChile"><meta property="og:locale" content="es_CL"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Auxiliaresenunciadosauxiliar 1","item":"\/auxiliaresenunciadosauxiliar-1\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="auxiliares single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/><img class=logo-light src=/images/banner.svg></img>
<img class=logo-dark src=/images/banner_dark.svg></img></a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/cc5327/apunte><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=/acerca>Info</a></li><li class=nav-item><a class=nav-link href=/auxiliares/enunciados/auxiliar-1>Auxiliares</a></li><li class=nav-item><a class=nav-link href=/tareas/>Tareas</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Buscar Documentaci칩n..." aria-label="Buscar Documentaci칩n..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>anexos</h3><ul class=list-unstyled><li><a class=docs-link href=/auxiliares/anexos/crime/>CRIME Attack</a></li><li><a class=docs-link href=/auxiliares/anexos/padding-oracle/>Padding Oracle Attack a CBC</a></li><li><a class=docs-link href=/auxiliares/anexos/python-bytes/>Strings y Bytes en Python 3</a></li><li><a class=docs-link href=/auxiliares/anexos/gdb/>Uso b치sico de GDB</a></li></ul><h3>enunciados</h3><ul class=list-unstyled><li><a class="docs-link active" href=/auxiliares/enunciados/auxiliar-1/>Auxiliar 1</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>Contenidos</h3><nav id=TableOfContents><ul><li><a href=#cifradores-de-bloque>Cifradores de Bloque</a><ul><li><a href=#algoritmos>Algoritmos</a></li><li><a href=#modos>Modos</a></li></ul></li><li><a href=#autentificaci칩n-de-mensajes>Autentificaci칩n de Mensajes</a></li><li><a href=#encriptar-y-autentificar>Encriptar y autentificar</a></li><li><a href=#funciones-de-hash>Funciones de Hash</a></li><li><a href=#n칰meros-pseudo-aleatorios>N칰meros Pseudo aleatorios</a></li><li><a href=#ejemplos-pr치cticos-de-temas-vistos-en-clase>Ejemplos pr치cticos de temas vistos en clase</a><ul><li><a href=#cifrado-de-bloques>Cifrado de Bloques</a></li><li><a href=#hashing>Hashing</a></li><li><a href=#generaci칩n-de-n칰meros-aleatorios>Generaci칩n de n칰meros aleatorios</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Auxiliar 1</h1><p class=lead></p><p>En esta <em>auxiliar</em> veremos el modo de uso de la librer칤a <a href=https://cryptography.io>Cryptography</a>, adem치s de algunos ejercicios relacionados con ella.</p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">游녤</div><div class=w-100>En aplicaciones reales, es muy poco probable que tengas que usar estas primitivas de forma directa. Por lo mismo, la librer칤a <em>Cryptography</em> las agrupa en un paquete denominado <em>hazmat</em> (en espa침ol, <em>material peligroso</em> que causa riesgos a la vida o al ambiente si no es manejado con precauci칩n)</div></div><h2 id=cifradores-de-bloque>Cifradores de Bloque<a href=#cifradores-de-bloque class=anchor aria-hidden=true>#</a></h2><p>Puedes ver la documentaci칩n de <em>Cryptography</em> sobre este tema <a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/>ac치</a>.</p><p><em>Criptography</em> define la siguiente interfaz para el uso de Cifradores:</p><ul><li><code>encryptor()</code>: Devuelve un contexto usable para encriptar datos</li><li><code>decryptor()</code>: Devuelve un contexto usable para desencriptar datos</li></ul><p>Al mismo tiempo, tanto <code>encryptor</code> como <code>decryptor</code> implementan los siguientes m칠todos</p><ul><li><code>update(_msg_)</code>: Agrega bytes a encriptar. Devuelve parte de los bytes encriptados (puede quedarse con algunos que no completan un bloque todav칤a)</li><li><code>finalize()</code>: Devuelve los bloques restantes a encriptar, <em>paddeados</em> de ser necesario para completar un bloque.</li></ul><p>Para levantar un cifrador de bloque, es necesario llamar al constructor de la clase <code>Cipher</code> con un <em>algoritmo</em> y un <em>modo</em>:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>os</span>
<span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives.ciphers</span> <span class=kn>import</span> <span class=n>Cipher</span><span class=p>,</span> <span class=n>algorithms</span><span class=p>,</span> <span class=n>modes</span>
<span class=kn>from</span> <span class=nn>cryptography.hazmat.backends</span> <span class=kn>import</span> <span class=n>default_backend</span>
<span class=n>backend</span> <span class=o>=</span> <span class=n>default_backend</span><span class=p>()</span> <span class=c1># Configuraci칩n que la librer칤a pide pero no usa por un problema de dise침o</span>
<span class=n>key</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>32</span><span class=p>)</span> <span class=c1># Llave usada por el cifrador de bloque</span>
<span class=n>iv</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span> <span class=c1># Vector de inicializaci칩n usado por el modo</span>
<span class=n>cipher</span> <span class=o>=</span> <span class=n>Cipher</span><span class=p>(</span><span class=n>algorithms</span><span class=o>.</span><span class=n>AES</span><span class=p>(</span><span class=n>key</span><span class=p>),</span> <span class=n>modes</span><span class=o>.</span><span class=n>CBC</span><span class=p>(</span><span class=n>iv</span><span class=p>),</span> <span class=n>backend</span><span class=o>=</span><span class=n>backend</span><span class=p>)</span>
<span class=n>encryptor</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>encryptor</span><span class=p>()</span> <span class=c1># Contexto de cifrado</span>
<span class=n>ct</span> <span class=o>=</span> <span class=n>encryptor</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;mensaje secreto!&#34;</span><span class=p>)</span> <span class=c1># Entrega parte de lo encriptado</span>
<span class=n>ct</span> <span class=o>+=</span> <span class=n>encryptor</span><span class=o>.</span><span class=n>finalize</span><span class=p>()</span> <span class=c1># Devuelve todo lo encriptado, en caso de haber quedado datos sin devolver anteriormente</span>
<span class=n>decryptor</span> <span class=o>=</span> <span class=n>cipher</span><span class=o>.</span><span class=n>decryptor</span><span class=p>()</span> <span class=c1># Contexto de descifrado</span>
<span class=k>print</span><span class=p>(</span><span class=n>decryptor</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span> <span class=o>+</span> <span class=n>decryptor</span><span class=o>.</span><span class=n>finalize</span><span class=p>())</span> <span class=c1># devuelve el texto completo descifrado</span>
<span class=c1># La 칰ltima instrucci칩n devolver칤a b&#39;mensaje secreto&#39;</span>
</code></pre></div><p>(Ejemplo obtenido de la documentaci칩n de <em>Cryptography</em>)</p><h3 id=algoritmos>Algoritmos<a href=#algoritmos class=anchor aria-hidden=true>#</a></h3><p>Los siguientes algoritmos son soportados por la librer칤a:</p><ul><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.AES>AES</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.Camellia>Camellia</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.ChaCha20>ChaCha20</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.TripleDES>3DES</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.CAST5>CAST5</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.SEED>SEED</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.Blowfish>Blowfish</a> <em>Inseguro</em></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.ARC4>ARC4</a> <em>Inseguro</em></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.algorithms.IDEA>IDEA</a> <em>Inseguro</em></li></ul><p>En todos los casos, el argumento del constructor recibe la llave sim칠trica a usar para cifrar la informaci칩n.</p><h3 id=modos>Modos<a href=#modos class=anchor aria-hidden=true>#</a></h3><p>La librer칤a soporta los siguientes modos:</p><ul><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.modes.CBC>Cipher Block Chaining (CBC)</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.modes.CBC>Counter (CTR)</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.modes.OFB>Output Feedback (OFB)</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.modes.CFB>Cipher Feedback (CFB)</a></li><li></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.modes.GCM>Galois Counter Mode (GCM)</a> <em>Encriptaci칩n autenticada</em></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.modes.XTS>XTS</a></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/symmetric-encryption/#cryptography.hazmat.primitives.ciphers.modes.ECB>Electronic Code Book (ECB)</a> <em>Inseguro. Adem치s requiere input con padding adecuado</em></li></ul><p>En todos los casos se recibe como primer argumento un <em>nonce</em> o <em>initialization vector</em>. Este valor entrega aleatoriedad al resultado del modo usado, y puede ser p칰blico sin comprometer la seguridad del sistema.</p><h2 id=autentificaci칩n-de-mensajes>Autentificaci칩n de Mensajes<a href=#autentificaci칩n-de-mensajes class=anchor aria-hidden=true>#</a></h2><p><em>Criptography</em> define la siguiente interfaz para el uso de MAC.</p><ul><li><code>update(msg)</code>: Similar al caso de cifrado, agrega bytes a firmar.</li><li><code>finalize()</code>: Devuelve la firma producida sobre los datos recibidos por <code>update</code>.</li><li><code>verify(sig)</code>: Compara la firma producida sobre los datos recibidos por <code>update</code>, con la firma recibida.</li></ul><p>La librer칤a soporta los siguientes tipos de MAC:</p><ul><li><a href=https://cryptography.io/en/latest/hazmat/primitives/mac/hmac/>HMAC</a>. Su constructor recibe una llave secreta, un algoritmo de hash y un <em>backend</em> (usar <code>default_backend()</code>)</li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/mac/cmac/>CMAC</a>. Su constructor recibe un algoritmo de cifrado (con llave definida) y un <em>backend</em> (usar <code>default_backend()</code>)</li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/mac/poly1305/>Poly1305</a>. Su constructor recibe solamente una llave.</li></ul><p>La documentaci칩n de <em>Cryptography</em> da el siguiente ejemplo para el MAC <em>Poly1305</em>:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives</span> <span class=kn>import</span> <span class=n>poly1305</span>
<span class=n>p</span> <span class=o>=</span> <span class=n>poly1305</span><span class=o>.</span><span class=n>Poly1305</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
<span class=n>p</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;message to authenticate&#34;</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>p</span><span class=o>.</span><span class=n>finalize</span><span class=p>())</span>
<span class=sa>b</span><span class=s1>&#39;T</span><span class=se>\xae\xff</span><span class=s1>3</span><span class=se>\xbd</span><span class=s1>W</span><span class=se>\xef\xd5</span><span class=s1>r</span><span class=se>\x01\xe2</span><span class=s1>n=</span><span class=se>\xb7\xd2</span><span class=s1>h&#39;</span>
<span class=n>p</span> <span class=o>=</span> <span class=n>poly1305</span><span class=o>.</span><span class=n>Poly1305</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
<span class=n>p</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;message to authenticate&#34;</span><span class=p>)</span>
<span class=n>p</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;an incorrect tag&#34;</span><span class=p>)</span> <span class=c1># Deber칤a tirar una excepci칩n</span>
</code></pre></div><h2 id=encriptar-y-autentificar>Encriptar y autentificar<a href=#encriptar-y-autentificar class=anchor aria-hidden=true>#</a></h2><p><em>Cryptography</em> adem치s provee de los siguientes modos de cifrado que integran autentificaci칩n, combinando tipos generalmente usados en conjunto:</p><ul><li><a href=https://cryptography.io/en/latest/hazmat/primitives/aead/#cryptography.hazmat.primitives.ciphers.aead.ChaCha20Poly1305>ChaCha20Poly1305</a>. Su constructor recibe solamente una llave.</li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/aead/#cryptography.hazmat.primitives.ciphers.aead.AESGCM>AES-GCM</a>. Su constructor recibe solamente una llave.</li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/aead/#cryptography.hazmat.primitives.ciphers.aead.ChaCha20Poly1305>AES-CCM</a>. Su constructor recibe una llave y un tama침o para el tag generado (por defecto es 16 y no se recomienda cambiarlo)</li></ul><p>Ejemplo con <em>ChaCha20Poly1305</em> de documentaci칩n de <em>Cryptography</em>:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>import</span> <span class=nn>os</span>
<span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives.ciphers.aead</span> <span class=kn>import</span> <span class=n>AESGCM</span>
<span class=n>data</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;a secret message&#34;</span>
<span class=n>aad</span> <span class=o>=</span> <span class=sa>b</span><span class=s2>&#34;authenticated but unencrypted data&#34;</span>
<span class=n>key</span> <span class=o>=</span> <span class=n>AESGCM</span><span class=o>.</span><span class=n>generate_key</span><span class=p>(</span><span class=n>bit_length</span><span class=o>=</span><span class=mi>128</span><span class=p>)</span>
<span class=n>aesgcm</span> <span class=o>=</span> <span class=n>AESGCM</span><span class=p>(</span><span class=n>key</span><span class=p>)</span>
<span class=n>nonce</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>urandom</span><span class=p>(</span><span class=mi>12</span><span class=p>)</span>
<span class=n>ct</span> <span class=o>=</span> <span class=n>aesgcm</span><span class=o>.</span><span class=n>encrypt</span><span class=p>(</span><span class=n>nonce</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>aad</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>aesgcm</span><span class=o>.</span><span class=n>decrypt</span><span class=p>(</span><span class=n>nonce</span><span class=p>,</span> <span class=n>ct</span><span class=p>,</span> <span class=n>aad</span><span class=p>))</span>
<span class=c1># Devuelve b&#39;a secret message&#39;</span>
</code></pre></div><h2 id=funciones-de-hash>Funciones de Hash<a href=#funciones-de-hash class=anchor aria-hidden=true>#</a></h2><p>La interfaz de las funciones de hash en <em>Cryptography</em> define los siguientes m칠todos:</p><ul><li><code>update(msg)</code>: Similar al caso de cifrado, agrega bytes a hashear.</li><li><code>finalize()</code>: Devuelve el hash producido sobre los datos recibidos por <code>update</code>.</li></ul><p>La librer칤a soporta las siguientes funciones de Hash:</p><ul><li><a href=https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/#sha-2-family>Familia SHA-2</a>, es decir, <em>SHA224</em>, <em>SHA256</em>, <em>SHA384</em>, <em>SHA512</em>, <em>SHA512-224</em> y <em>SHA512-256</em>.</li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/#blake2>Blake2</a>, en versiones optimizadas para distintos procesadores. El constructor recibe un par치metro equivalente al tama침o del hash deseado, entre 1 y 64 bytes.</li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/#sha-3-family>Familia SHA-3</a> , es decir, <em>SHA3-224</em>, <em>SHA3-256</em>, <em>SHA3-384</em>, <em>SHA3-512</em>, <em>SHAKE128</em> y <em>SHAKE256</em>. Las 칰ltimas dos funciones de hash reciben de par치metro el tama침o del hash deseado.</li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/#sha-1>SHA-1</a> <em>Insegura</em></li><li><a href=https://cryptography.io/en/latest/hazmat/primitives/cryptographic-hashes/#cryptography.hazmat.primitives.hashes.MD5>MD5</a> <em>Insegura</em></li></ul><p>Ejemplo de la librer칤a:</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>cryptography.hazmat.backends</span> <span class=kn>import</span> <span class=n>default_backend</span>
<span class=kn>from</span> <span class=nn>cryptography.hazmat.primitives</span> <span class=kn>import</span> <span class=n>hashes</span>
<span class=n>digest</span> <span class=o>=</span> <span class=n>hashes</span><span class=o>.</span><span class=n>Hash</span><span class=p>(</span><span class=n>hashes</span><span class=o>.</span><span class=n>SHA256</span><span class=p>(),</span> <span class=n>backend</span><span class=o>=</span><span class=n>default_backend</span><span class=p>())</span>
<span class=n>digest</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;abc&#34;</span><span class=p>)</span>
<span class=n>digest</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=sa>b</span><span class=s2>&#34;123&#34;</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>digest</span><span class=o>.</span><span class=n>finalize</span><span class=p>())</span>
<span class=c1># mostrar칤a b&#39;l\xa1=R\xcap\xc8\x83\xe0\xf0\xbb\x10\x1eBZ\x89\xe8bM\xe5\x1d\xb2\xd29%\x93\xafj\x84\x11\x80\x90&#39;</span>
</code></pre></div><h2 id=n칰meros-pseudo-aleatorios>N칰meros Pseudo aleatorios<a href=#n칰meros-pseudo-aleatorios class=anchor aria-hidden=true>#</a></h2><p>En Python, se suele usar la funci칩n <code>os.urandom(len)</code> para generar aleatoriedad criptogr치ficamente segura. Sin embargo, como se vio en clases, muchas veces esta seguridad depende de la cantidad de entrop칤a a la que nuestro computador tiene acceso.</p><p>En Linux, la funci칩n anteriormente mencionada obtiene aleatoriedad del dispositivo <code>/dev/urandom</code>, mientras que en Windows se obtiene de la funci칩n <code>CryptGenRandom</code>.</p><p>Por lo tanto, al crear variables aleatorias para su uso en otras funciones criptogr치ficas (como por ejemplo, para claves o vectores de inicializaci칩n), se debe usar <code>os.urandom(len)</code>.</p><p>Desde Python 3.6, es posible usar la funci칩n <code>secrets.token_bytes(n)</code> de la librer칤a <a href=https://docs.python.org/3/library/secrets.html>secrets</a> para obtener un arreglo de bytes de largo n.</p><h2 id=ejemplos-pr치cticos-de-temas-vistos-en-clase>Ejemplos pr치cticos de temas vistos en clase<a href=#ejemplos-pr치cticos-de-temas-vistos-en-clase class=anchor aria-hidden=true>#</a></h2><p>A continuaci칩n veremos algunos problemas vistos en clase, pero usando c칩digo en Python. El c칩digo fuente usado se puede encontrar en la secci칩n <em>Material Docente</em> del curso.</p><h3 id=cifrado-de-bloques>Cifrado de Bloques<a href=#cifrado-de-bloques class=anchor aria-hidden=true>#</a></h3><p>En clases vimos que el Modo ECB puede filtrar informaci칩n estructural de los datos encriptados. El t칤pico ejemplo de este problema es la siguiente imagen de la mascota de Linux, Tux.</p><h4 id=imagen-original>Imagen Original<a href=#imagen-original class=anchor aria-hidden=true>#</a></h4><p><img src=https://upload.wikimedia.org/wikipedia/commons/5/56/Tux.jpg alt="Imagen Original"></p><h4 id=imagen-encriptada-en-ecb>Imagen encriptada en ECB<a href=#imagen-encriptada-en-ecb class=anchor aria-hidden=true>#</a></h4><p><img src=https://upload.wikimedia.org/wikipedia/commons/f/f0/Tux_ecb.jpg alt="Imagen Encriptada en ECB"></p><h4 id=imagen-encriptada-con-un-modo-m치s-seguro>Imagen encriptada con un modo m치s seguro<a href=#imagen-encriptada-con-un-modo-m치s-seguro class=anchor aria-hidden=true>#</a></h4><p><img src=https://upload.wikimedia.org/wikipedia/commons/a/a0/Tux_secure.jpg alt="Imagen Encriptada con CBC o CTR"></p><p><em>(La historia de c칩mo esta imagen se hizo tan famosa es bastante interesante, y la pueden encontrar <a href=https://blog.filippo.io/the-ecb-penguin/>ac치</a>)</em></p><p>El c칩digo <code>encrypt_image.py</code> toma la imagen <code>tux.png</code> y la encripta en modo ECB, dej치ndola en el archivo <code>tux_encrypted.png</code>. Si bien cada vez que ejecutes el c칩digo la imagen ser치 distinta, la silueta se debiese de poder ver claramente en la mayor칤a de los casos.</p><ul><li>Cambia el cifrador de bloques y revisa si esta situaci칩n cambia</li><li>Cambia el modo de encriptaci칩n y revisa si esta situaci칩n cambia</li></ul><h3 id=hashing>Hashing<a href=#hashing class=anchor aria-hidden=true>#</a></h3><p>A veces, al bajar archivos de Internet, es normal encontrarse con que al lado de lo descargado hay un <em>hash</em>. Este valor se usa para demostrar que el archivo que bajaste es el mismo que qui칠n lo public칩 quer칤a que bajaras, ya que dentro de las propiedades de un buen hash criptogr치fico, se encuentra la dificultad de encontrar un segundo valor que al ser hasheado entregue el mismo hash que otro valor.</p><p>En algunos casos, hasta el d칤a de hoy se siguen usando funciones de hash rotas (como MD5 y SHA1) para realizar este c치lculo, lo que hace que esta verificaci칩n pierda valor.</p><p><em>(<a href=https://alf.nu/SHA1>Ac치</a> puedes ver un ejemplo que utiliza la vulnerabilidad SHAttered, descubierta el 2017, para generar 2 PDF distintos con el mismo valor de hash)</em></p><p>Sin embargo, incluso usando funciones de hash seguras, nada asegura que el usuario comparar치 letra por letra el hash calculado sobre el archivo con el hash publicado. Muchas veces, uno se conforma comparando los primeros y/o 칰ltimos caracteres de ambos hashes.</p><p>Se les pide modificar <code>script_virus.sh</code>, de tal forma que sus primeros 2 y 칰ltimos 2 caracteres del hash <em>SHA256</em> sean los mismos que los del archivo <code>script_bueno.sh</code>, y siga ejecutando el c칩digo que ejecuta actualmente.</p><p>Para determinar c칩mo leer y calcular el hash de un archivo, basarse en el script <code>calculate_hash.py</code> adjunto en el material de la clase.</p><h3 id=generaci칩n-de-n칰meros-aleatorios>Generaci칩n de n칰meros aleatorios<a href=#generaci칩n-de-n칰meros-aleatorios class=anchor aria-hidden=true>#</a></h3><p>Usando la versi칩n modificada del generador pseudoaleatorio definido en clases, disponible en el archivo <code>prng.py</code>, generar una clave de 32 bytes. Luego, intentar adivinar la clave generada aprovech치ndose de un problema de implementaci칩n fundamental de este generador.</p><ul><li>쮺칩mo var칤a la efectividad la estrategia seg칰n el tama침o de <code>SEED_SIZE</code>?</li><li>쮺칩mo var칤a la efectividad de la estrategia seg칰n el tama침o de <code>KEY_SIZE</code>?</li></ul><p class=edit-page><a href=https://github.com/cc5327/apunte/blob/main/content/auxiliares/enunciados/auxiliar-1.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Editar en GitHub</a>
<span class=date-info><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Modificado por 칰ltima vez el 02/04/2022 a las 23:10:02 hrs.</span></p><div class="docs-navigation d-flex justify-content-between"><a class=ml-auto href=/auxiliares/anexos/crime/><div class="card my-1"><div class="card-body py-2">CRIME Attack &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Sitio generado con <a href=https://gohugo.io/>Hugo</a> y <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target=_blank rel="license noopener noreferrer" style=display:inline-block>CC BY-SA 4.0<img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></ul></div></div></div></footer><script src=/main.2507c05f91ee016250e43b67b3d342f5a0d9d4dc5264f76cdc4518cd36a9e04cf3022ce8362802e618d8130b6733b53ee845a49e67229eeb3d3e70347db96a2b.js integrity="sha512-JQfAX5HuAWJQ5Dtns9NC9aDZ1NxSZPds3EUYzTap4EzzAizoNigC5hjYEwtnM7U+6EWknmcinus9PnA0fblqKw==" crossorigin=anonymous defer></script><script src=/index.min.95c2fb57984ca6cb1914e6658c1095cc47073a398c805d5ee842114fab739d64b4d5cd0626cda1be56c95e7f8c6e9c4d231866d1065245c873d731a6a7b01c5e.js integrity="sha512-lcL7V5hMpssZFOZljBCVzEcHOjmMgF1e6EIRT6tznWS01c0GJs2hvlbJXn+MbpxNIxhm0QZSRchz1zGmp7AcXg==" crossorigin=anonymous defer></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>